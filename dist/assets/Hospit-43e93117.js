import{f as A,o as g,c as f,i as s,D as V,d as R,r as C,g as $,a as I,w as D,v as U,b as q,j as z,E as W,k as Y,H as F,u as K,t as m,l as P}from"./index-7f288414.js";import{_ as G}from"./Vector2-1f104793.js";import{_ as Q}from"./SideBar.vue_vue_type_style_index_0_lang-cd63c36e.js";import{P as X,W as Z,g as J,_ as ee}from"./index.esm2017-bf5df4d7.js";const te={},oe={class:"custom-alert"},se={class:"custom-alert-content"};function ae(b,a){return g(),f("div",oe,[s("div",se,[V(b.$slots,"default",{},void 0,!0)]),s("button",{class:"custom-alert-close",onClick:a[0]||(a[0]=d=>b.$emit("close"))},"Ã—")])}const ne=A(te,[["render",ae],["__scopeId","data-v-e939715d"]]),re={class:"container-fluid"},ce={class:"row"},ie={class:"col"},le={class:"row justify-content-center align-items-center"},de={class:"col-md-8 mt-5"},pe=s("nav",{"aria-label":"Breadcrumb"},null,-1),ue={class:"input-group flex-nowrap mt-5"},me=s("span",{class:"input-group-text px-3",id:"addon-wrapping",style:{"border-radius":"2px 0 0 2px"}},[s("i",{class:K(["fal","fa-search-location"])})],-1),_e=s("div",{id:"map"},null,-1),ge={class:"container pl-5 mt-5"},he=s("h2",{class:"text-gray"},"Nearby Hospitals:",-1),ve={class:"row"},fe={class:"card-body pt-5"},be=["src"],ye={class:"card-title mt-2"},we={class:"card-text"},xe={class:"card-text"},Ce={class:"card-text"},ke={class:"card-text"},Se={class:"card-text"},Ee={class:"card-text"},Pe=["href"],Ne=R({__name:"Hospit",setup(b){let a,d,h;const p=[],y=C(""),l=C([]),k=async e=>{try{const t=e.filter(o=>o!==void 0);if(t.length>0){const o=X(),n=Z(o);t.forEach(r=>{const{name:u,vicinity:_}=r,i=J(ee(o,"hospitals")),c={name:u,vicinity:_};n.set(i,c)}),await n.commit(),console.log("Hospitals saved to Firebase:",t),window.alert("Hospitals data saved successfully! YAY"),w.value=!0}else console.warn("No valid hospitals data to save."),window.alert("No valid hospitals data to save.")}catch(t){console.error("Error saving hospitals:",t),alert(t)}},w=C(!1),H=async()=>{try{await k(l.value)}catch(e){console.error("Error saving hospitals:",e),alert(e)}},B=()=>{a=new google.maps.Map(document.getElementById("map"),{center:{lat:9.0778,lng:8.6775},zoom:6}),h=new google.maps.places.SearchBox(document.getElementById("search-box"));const e=document.createElement("button");e.textContent="Pan to Current Location",e.classList.add("custom-map-control-button"),a.controls[google.maps.ControlPosition.TOP_CENTER].push(e),e.addEventListener("click",()=>{M()}),d=new google.maps.InfoWindow,a.addListener("bounds_changed",()=>{h.setBounds(a.getBounds())}),h.addListener("places_changed",()=>{const t=h.getPlaces();if(t.length===0)return;p.forEach(n=>n.setMap(null)),p.length=0;const o=new google.maps.LatLngBounds;t.forEach(n=>{if(!n.geometry){console.log("Returned place contains no geometry");return}const r=new google.maps.Marker({map:a,position:n.geometry.location,title:n.name});p.push(r),o.extend(n.geometry.location)}),a.fitBounds(o)})},S=(e,t,o)=>{t.setPosition(o),t.setContent(e?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation."),t.open(a)},L=()=>{if(y.value){const e={location:a.getCenter(),radius:5e3,keyword:"hospital"};new google.maps.places.PlacesService(a).nearbySearch(e,(o,n)=>{n===google.maps.places.PlacesServiceStatus.OK&&o&&(l.value=o,p.forEach(r=>r.setMap(null)),p.length=0,o.forEach(r=>{if(r.geometry&&r.geometry.location){const u=new google.maps.Marker({map:a,position:r.geometry.location,title:r.name});p.push(u)}}))})}},M=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{const t={lat:e.coords.latitude,lng:e.coords.longitude};d.setPosition(t),d.setContent("Location found."),d.open(a),a.setCenter(t),O(t)},()=>{S(!0,d,a.getCenter())}):S(!1,d,a.getCenter())},N=()=>{const t=(u=>{const _=Object.keys(u[0]).join(",")+`
`,i=u.map(c=>Object.values(c).join(",")+`
`);return _+i.join("")})(l.value),o=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(o),r=document.createElement("a");r.href=n,r.setAttribute("download","hospitals.csv"),r.click(),alert("Download Successful")},O=e=>{const t={location:e,radius:1e3,type:"hospital",fields:["formatted_phone_number","opening_hours","website"]},o=new google.maps.places.PlacesService(a);o.nearbySearch(t,(n,r)=>{if(r===google.maps.places.PlacesServiceStatus.OK){const _=n.map(i=>i.place_id).map(i=>new Promise(c=>{o.getDetails({placeId:i,fields:["opening_hours"]},(x,v)=>{v===google.maps.places.PlacesServiceStatus.OK?c(x):c(null)})}));Promise.all(_).then(i=>{l.value=n.map((c,x)=>{var v;return{place_id:c.place_id,name:c.name,vicinity:c.vicinity,formatted_phone_number:c.formatted_phone_number,opening_hours:(v=i[x])==null?void 0:v.opening_hours,website:c.website,photoUrl:E(c)}}),k(l.value),clearMarkers(),T(n)})}})},j=e=>!!(e&&e.isOpen()),E=e=>e.photos&&e.photos.length>0?e.photos[0].getUrl({maxWidth:300,maxHeight:300}):"",T=e=>{for(const t of e)if(t.geometry&&t.geometry.location){const o=new google.maps.Marker({position:t.geometry.location,map:a});p.push(o)}};return $(()=>{const e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAY2ez0sDkoi-3VjuLN98e1EZRsHHX2RqM&libraries=places&callback=initMap",e.defer=!0,e.async=!0,document.head.appendChild(e),window.initMap=B}),(e,t)=>(g(),f("div",re,[s("div",ce,[I(Q),s("div",ie,[s("div",le,[s("div",de,[pe,s("div",ue,[me,D(s("input",{type:"search",class:"form-control p-4",placeholder:"Search hospital",id:"search-box",name:"address","onUpdate:modelValue":t[0]||(t[0]=o=>y.value=o),"aria-describedby":"addon-wrapping",autocomplete:"on",required:"",style:{"border-radius":"0 2px   2px 0"}},null,512),[[U,y.value]]),s("button",{onClick:L,style:{padding:"13px 40px","margin-left":"10px","border-radius":"10px",border:"none"}},"Search")]),_e])]),s("div",ge,[he,s("ul",ve,[(g(!0),f(q,null,z(l.value,o=>(g(),f("li",{key:o.place_id,class:"card col-sm-3 m-4 border-0",style:{width:"600px"},onSubmit:t[1]||(t[1]=(...n)=>l.value&&l.value(...n))},[s("div",fe,[s("img",{src:E(o),alt:"Hospital Photo",style:{"border-radius":"10px",width:"10rem",height:"10rem"}},null,8,be),s("h5",ye,m(o.name),1),s("p",we,m(o.vicinity),1),s("p",xe,m(o.place_id),1),s("p",Ce," Hospital Rating: "+m(o.rating||"No ratings yet"),1),s("p",ke,"Phone Number: "+m(o.formatted_phone_number||"Not Available"),1),s("p",Se,"Opening Hours: "+m(j(o.opening_hours)?"Open":"Closed"),1),s("p",Ee,[P("Website: "),s("a",{href:o.website,target:"_blank"},m(o.website||"Not Available"),9,Pe)]),s("img",{src:G,onClick:N,style:{width:"25px",height:"25px"}})])],32))),128)),w.value?(g(),W(ne,{key:0,onClose:t[2]||(t[2]=o=>w.value=!1)},{default:Y(()=>[P(" Hospitals data saved successfully! ")]),_:1})):F("",!0)]),s("div",{class:"text-center"},[s("button",{onClick:H,class:"btn btn-primary p-3 btn-lg"},"Save Hospitals")])])])])]))}});export{Ne as default};
